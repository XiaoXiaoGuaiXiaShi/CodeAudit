文件操作包括文件包含、文件读取、文件删除、文件修改以及文件上传。

## 1 审计经验

#### 1.1 业务功能点
- 1）文件管理功能。在文件管理功能中，如果程序将文件名或者文件路径直接在参数中传递，则很有可能会存在任意文件操作的漏洞，比如任意文件读取等，利用的方式是在路径中使用../或者..\跳转目录。
- 2）文件包含漏洞大多出现在模块加载、模版加载以及cache调用的地方，如传入的模块名参数实际上是直接拼接到了包含文件的路径中。
- 3）文件上传功能。比如像文章编辑、资料编辑、头像上传、附件上传，后端没有严格地限制上传文件的格式，导致可以直接上传或者存在绕过的情况。

#### 1.2 审计思路
- 1）文件包含漏洞审计：可以看看模块加载时包含的文件是否可控。或者直接搜索include()、include_once()、require()、require_once()这四个函数来回溯看是否有可控的变量。
> 文件包含函数有include()、include_once()、require()、require_once()。它们之间的区别在于：include()和include_once()在包含文件时即使遇到错误，下面的代码依然会继续执行；而require()和require_once()则会直接报错退出程序。


## 2 常见实例

#### 2.1 代码审计

#### 2.2 开源实例
- 1）espcms 文件包含

## 参考：
1、《代码审计  企业级Web代码安全架构》 尹毅
2、