## 1 审计经验

#### 1.1 业务功能点
- 1）文件管理功能。程序会在页面中输出文件名，而通常会疏忽对文件名进行过滤，导致可以在数据库中存入带有尖括号等特殊符号的文件名，最后显示在页面上的时候就会被执行。
- 2）文章发表、评论回复、留言以及资料设置等地方，经常出现对标签事件过滤不严格导致的XSS。

#### 1.2 审计思路
- 1）寻找没有被过滤的参数，且这些参数传入到输出函数。常用的输出函数有：print、print_r、echo、printf、sprintf、die、var_dump、var_export。根据输出函数对输出内容回溯输入参数，观察是否经过过滤。

#### 1.3 漏洞防范
- 1）特殊字符HTML实体转码：一般的XSS漏洞都是因为没过滤特殊字符，导致可以通过注入单双引号以及尖括号等字符利用漏洞。为了保证数据原始性，最好的过滤方式是在输出和二次调用的时候进行如HTML实体一类的转码，防止脚本注入的问题。
- 2）标签事件属性黑白名单。


## 2 常见实例

#### 2.1 代码审计
xss代码审计

#### 2.2 开源实例
- 1）骑士cms存储型XSS



## 参考：
1、《代码审计  企业级Web代码安全架构》 尹毅